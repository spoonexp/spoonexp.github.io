{"version":3,"sources":["webpack:///./src/views/Vault.vue","webpack:///./src/views/Vault.vue?cd9e"],"names":["class","formatBN","tvl","pools","item","key","lpName","pool","name","components","Tooltip","LendCareTr","data","hidden","filter","p","isVault","watch","account","this","loadData","mounted","$store","state","methods","FTMUSDCVault","lendContract","vault","wantToken","FTMUSDClp","getReserves","ftmUsdcReserves","ftmPrice","toString","dividedBy","i","length","lp","token0","token0addr","token1","token1addr","reserves","toLowerCase","balanceOf","multipliedBy","totalSupply","plus","render"],"mappings":"8wQACOA,MAAM,8B,GACJA,MAAM,8D,EACT,eAAmD,OAA9CA,MAAM,YAAW,2BAAuB,G,GAE3CA,MAAM,sH,GAEDA,MAAM,qB,GACJA,MAAM,gE,iBAA+D,wB,GAMvEA,MAAM,sC,GAGVA,MAAM,sE,GACJA,MAAM,sB,6UAjBf,eA+BM,MA/BN,EA+BM,CA9BJ,eAcM,MAdN,EAcM,CAbJ,EACA,eAWM,MAXN,EAWM,CARJ,eAKM,MALN,EAKM,CAJJ,eAGM,MAHN,EAGM,C,4BAGR,eAAkG,MAAlG,EAAgD,IAAC,eAAG,EAAAC,SAAS,EAAAC,IAAG,2BAGpE,eAcM,MAdN,EAcM,CAbJ,eAYM,MAZN,EAYM,CAXJ,EAQA,eAEM,a,mBADJ,eAA+E,2BAApD,EAAAC,OAAK,SAAbC,G,wBAAnB,eAA+E,GAA5CC,IAAKD,EAAKE,OAASC,KAAMH,G,yLAevD,GACbI,KAAM,OACNC,WAAY,CACVC,UAAA,KACAC,aAAA,MAEFC,KANa,WAOX,MAAO,CACLC,QAAQ,EACRX,IAAK,IAAI,IAAU,GACnBC,MAAO,OAAWW,QAAO,SAACC,GAAD,OAAOA,EAAEC,aAGtCC,MAAO,CACL,uBAAwB,SAAUC,GAC5BA,GACFC,KAAKC,aAIXC,QApBa,WAqBPF,KAAKG,OAAOC,MAAML,SACpBC,KAAKC,YAGTI,QAAS,CACDJ,SADC,WACU,qLACf,EAAKlB,IAAM,IAAI,IAAU,KACnBuB,EAAe,eAAY,OAAW,GAAGC,aAAcC,GAF9C,KAGG,OAHH,SAGqBF,EAAaG,YAHlC,+BAG+C,EAAxDC,GAHS,6BAIeA,EAAUC,cAJzB,QAITC,EAJS,OAKTC,EAAW,IAAI,IAAUD,EAAgB,GAAGE,YAC/CC,UAAU,KACVA,UACC,IAAI,IAAUH,EAAgB,GAAGE,YAAYC,UAAU,OAElDC,EAAI,EAVE,aAUCA,EAAI,EAAKhC,MAAMiC,QAVhB,wBAWPrB,EAAI,EAAKZ,MAAMgC,GACf5B,EAAO,eAAYQ,EAAEW,aAAcC,GAZ5B,UAaOpB,EAAKqB,YAbZ,eAabb,EAAEa,UAbW,OAcPS,EAAK,eAAYtB,EAAEa,UAAW,GAdvB,UAeQS,EAAGC,SAfX,eAebvB,EAAEwB,WAfW,iBAgBQF,EAAGG,SAhBX,eAgBbzB,EAAE0B,WAhBW,iBAkBUZ,EAAUC,cAlBpB,eAkBPY,EAlBO,YAmBF,EAAKxC,IAnBH,KAoBX8B,EApBW,KAqBT,IAAI,IACFU,EACE3B,EAAEwB,WAAWI,gBAAkB,OAAc,EAAI,GACjDV,YAxBK,UA0BcI,EAAGO,UAAU7B,EAAEW,cA1B7B,2BA0B4CO,WA1B5C,UA0BNY,aA1BM,0BA2BWR,EAAGS,cA3Bd,oBA2B6Bb,WA3B7B,UA2BNC,UA3BM,gBA4BNA,UAAU,MA5BJ,WAoBFW,aApBE,gBAmBb,EAAK3C,IAnBQ,KAmBO6C,KAnBP,yBAUwBZ,IAVxB,iEClErB,EAAOa,OAASA,EAED","file":"js/chunk-7523b76b.17bd6941.js","sourcesContent":["<template>\n  <div class=\"container mx-auto mt-4 p-4\">\n    <div class=\"flex justify-center items-end flex-wrap md:justify-between\">\n      <div class=\"text-2xl\">Available Lending Pools</div>\n      <div\n        class=\"flex flex-col items-center justify-center border border-solid border-gray-200 rounded-3xl p-4 px-8 bg-white shadow\"\n      >\n        <div class=\"flex items-center\">\n          <div class=\"relative flex items-center text-xl font-bold leading-10 mr-1\">\n            Total Value Locked\n            <Tooltip v-if=\"false\" class=\"ml-1\"></Tooltip>\n          </div>\n        </div>\n\n        <div class=\"text-3xl text-green-400 leading-10\">${{ formatBN(tvl, { decimals: 0, dp: 2 }) }}</div>\n      </div>\n    </div>\n    <div class=\"flex border border-solid rounded-3xl shadow bg-white p-6 px-0 mt-6\">\n      <div class=\"table-fixed w-full\">\n        <div>\n          <ul class=\"flex text-center\">\n            <li class=\"w-5/12 hidden md:block\"></li>\n            <li class=\"w-5/12 md:w-3/12\">Total Supply</li>\n            <li class=\"w-5/12 md:w-3/12\">Your Balance</li>\n            <li class=\"w-2/12\"></li>\n          </ul>\n        </div>\n        <div>\n          <LendCareTr v-for=\"item in pools\" :key=\"item.lpName\" :pool=\"item\"></LendCareTr>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Tooltip from \"@/components/Tooltip\";\nimport LendCareTr from \"@/components/LendCareTr\";\nimport { stakePools, wftmAddress } from \"@/config\";\nimport { getContract } from \"@/utils/initWeb3\";\nimport vaultABI from \"@/assets/abi/vault.json\";\nimport lpABI from \"@/assets/abi/LP.json\";\nimport BigNumber from \"bignumber.js\";\nexport default {\n  name: \"Lend\",\n  components: {\n    Tooltip,\n    LendCareTr,\n  },\n  data() {\n    return {\n      hidden: false,\n      tvl: new BigNumber(0),\n      pools: stakePools.filter((p) => p.isVault),\n    };\n  },\n  watch: {\n    \"$store.state.account\": function (account) {\n      if (account) {\n        this.loadData();\n      }\n    },\n  },\n  mounted() {\n    if (this.$store.state.account) {\n      this.loadData();\n    }\n  },\n  methods: {\n    async loadData() {\n      this.tvl = new BigNumber(\"0\");\n      const FTMUSDCVault = getContract(stakePools[8].lendContract, vaultABI);\n      const FTMUSDClp = getContract(await FTMUSDCVault.wantToken(), lpABI);\n      const ftmUsdcReserves = await FTMUSDClp.getReserves();\n      const ftmPrice = new BigNumber(ftmUsdcReserves[0].toString())\n        .dividedBy(1e6)\n        .dividedBy(\n          new BigNumber(ftmUsdcReserves[1].toString()).dividedBy(1e18)\n        );\n      for (let i = 0; i < this.pools.length; i++) {\n        const p = this.pools[i];\n        const pool = getContract(p.lendContract, vaultABI);\n        p.wantToken = await pool.wantToken();\n        const lp = getContract(p.wantToken, lpABI);\n        p.token0addr = await lp.token0();\n        p.token1addr = await lp.token1();\n        // 取 lp 余额\n        const reserves = await FTMUSDClp.getReserves();\n        this.tvl = this.tvl.plus(\n          ftmPrice.multipliedBy(\n            new BigNumber(\n              reserves[\n                p.token0addr.toLowerCase() === wftmAddress ? 0 : 1\n              ].toString()\n            )\n              .multipliedBy((await lp.balanceOf(p.lendContract)).toString())\n              .dividedBy((await lp.totalSupply()).toString())\n              .dividedBy(1e18)\n          )\n        );\n      }\n    },\n  },\n};\n</script>\n","import { render } from \"./Vault.vue?vue&type=template&id=3b172da0\"\nimport script from \"./Vault.vue?vue&type=script&lang=js\"\nexport * from \"./Vault.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}